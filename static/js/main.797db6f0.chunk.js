(this["webpackJsonpchess-board"]=this["webpackJsonpchess-board"]||[]).push([[0],{10:function(e,t,n){e.exports={container:"App_container__3Hag2",chessGrid:"App_chessGrid__3cPOC",chessSquare:"App_chessSquare__SDQaO",light:"App_light__3AKuB",highlighted:"App_highlighted__19TOk",rank:"App_rank__3KL7s",file:"App_file__3wQ0V",infoPane:"App_infoPane__11ld2"}},11:function(e,t,n){e.exports={promotionSection:"Promotion_promotionSection__2kVma",chessSquare:"Promotion_chessSquare__35EZO",chessRow:"Promotion_chessRow__22-_I"}},16:function(e,t,n){e.exports={active:"draggable_active__3TbHp"}},23:function(e,t,n){},26:function(e,t,n){"use strict";n.r(t);var a=n(1),i=n.n(a),r=n(15),c=n.n(r),s=(n(23),n(7)),o=n(16),l=n.n(o),u=n(0),h=function(e){var t=e.children,n=e.boundingBox,r=e.onMouseDown,c=e.onMouseMove,o=e.onMouseUp,h=Object(a.useState)({x:0,y:0,pressed:!1}),f=Object(s.a)(h,2),v=f[0],d=f[1],b=Object(a.useState)({x:0,y:0}),p=Object(s.a)(b,2),j=p[0],k=p[1],O=Object(a.useRef)(null);Object(a.useEffect)((function(){O.current&&v.pressed?O.current.style.transform="translate(".concat(j.x,"px, ").concat(j.y,"px)"):O.current&&(O.current.style.transform="")}),[j,v.pressed]);var g=i.a.useCallback((function(){d({x:0,y:0,pressed:!1}),k({x:0,y:0}),null===o||void 0===o||o(-1,-1)}),[o]),w=i.a.useCallback((function(e){var t;t="mousemove"===e.type?e:e.touches[0];var a=n?Math.max(Math.min(t.pageX,n.right),n.left):t.pageX,i=n?Math.max(Math.min(t.pageY,n.bottom),n.top):t.pageY,r=a-v.x,s=i-v.y;null===c||void 0===c||c(a,i),k({x:r,y:s})}),[v,n,c]),x=Object(a.useRef)(w);Object(a.useEffect)((function(){v.pressed?(x.current=w,document.addEventListener("mousemove",w),document.addEventListener("mouseup",g),document.addEventListener("touchmove",w),document.addEventListener("touchend",g)):(document.removeEventListener("mousemove",x.current),document.removeEventListener("mouseup",g),document.removeEventListener("touchmove",x.current),document.removeEventListener("touchend",g))}),[v.pressed,w,g]);var m=function(e){var t,a;a="mousedown"===e.type?e:e.touches[0];var i=null===(t=O.current)||void 0===t?void 0:t.getBoundingClientRect(),c=a.pageX,s=a.pageY;i&&(c=(null===i||void 0===i?void 0:i.x)+(null===i||void 0===i?void 0:i.width)/2,s=(null===i||void 0===i?void 0:i.y)+(null===i||void 0===i?void 0:i.height)/2);var o=n?Math.max(Math.min(a.pageX,n.right),n.left):a.pageX,l=n?Math.max(Math.min(a.pageY,n.bottom),n.top):a.pageY;k({x:o-c,y:l-s}),null===r||void 0===r||r(o,l),d({x:c,y:s,pressed:!0})};return Object(u.jsx)("div",{className:v.pressed?l.a.active:"",ref:O,onMouseDown:m,onTouchStart:m,children:t})},f=n(2);function v(e){return Object(u.jsx)("svg",Object(f.a)(Object(f.a)({xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 45 45"},e),{},{children:Object(u.jsxs)("g",{fill:"none",fillRule:"evenodd",stroke:"#000",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",children:[Object(u.jsxs)("g",{fill:"#000",strokeLinecap:"butt",children:[Object(u.jsx)("path",{d:"M9 36c3.39-.97 10.11.43 13.5-2 3.39 2.43 10.11 1.03 13.5 2 0 0 1.65.54 3 2-.68.97-1.65.99-3 .5-3.39-.97-10.11.46-13.5-1-3.39 1.46-10.11.03-13.5 1-1.35.49-2.32.47-3-.5 1.35-1.46 3-2 3-2z"}),Object(u.jsx)("path",{d:"M15 32c2.5 2.5 12.5 2.5 15 0 .5-1.5 0-2 0-2 0-2.5-2.5-4-2.5-4 5.5-1.5 6-11.5-5-15.5-11 4-10.5 14-5 15.5 0 0-2.5 1.5-2.5 4 0 0-.5.5 0 2z"}),Object(u.jsx)("path",{d:"M25 8a2.5 2.5 0 11-5 0 2.5 2.5 0 115 0z"})]}),Object(u.jsx)("path",{d:"M17.5 26h10M15 30h15m-7.5-14.5v5M20 18h5",stroke:"#fff",strokeLinejoin:"miter"})]})}))}var d=a.memo(v);function b(e){return Object(u.jsx)("svg",Object(f.a)(Object(f.a)({xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 45 45"},e),{},{children:Object(u.jsxs)("g",{fill:"none",fillRule:"evenodd",stroke:"#000",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",children:[Object(u.jsxs)("g",{fill:"#fff",strokeLinecap:"butt",children:[Object(u.jsx)("path",{d:"M9 36c3.39-.97 10.11.43 13.5-2 3.39 2.43 10.11 1.03 13.5 2 0 0 1.65.54 3 2-.68.97-1.65.99-3 .5-3.39-.97-10.11.46-13.5-1-3.39 1.46-10.11.03-13.5 1-1.35.49-2.32.47-3-.5 1.35-1.46 3-2 3-2z"}),Object(u.jsx)("path",{d:"M15 32c2.5 2.5 12.5 2.5 15 0 .5-1.5 0-2 0-2 0-2.5-2.5-4-2.5-4 5.5-1.5 6-11.5-5-15.5-11 4-10.5 14-5 15.5 0 0-2.5 1.5-2.5 4 0 0-.5.5 0 2z"}),Object(u.jsx)("path",{d:"M25 8a2.5 2.5 0 11-5 0 2.5 2.5 0 115 0z"})]}),Object(u.jsx)("path",{d:"M17.5 26h10M15 30h15m-7.5-14.5v5M20 18h5",strokeLinejoin:"miter"})]})}))}var p=a.memo(b);function j(e){return Object(u.jsx)("svg",Object(f.a)(Object(f.a)({xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 45 45"},e),{},{children:Object(u.jsxs)("g",{fill:"none",fillRule:"evenodd",stroke:"#000",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",children:[Object(u.jsx)("path",{d:"M22.5 11.63V6",strokeLinejoin:"miter"}),Object(u.jsx)("path",{d:"M22.5 25s4.5-7.5 3-10.5c0 0-1-2.5-3-2.5s-3 2.5-3 2.5c-1.5 3 3 10.5 3 10.5",fill:"#000",strokeLinecap:"butt",strokeLinejoin:"miter"}),Object(u.jsx)("path",{d:"M12.5 37c5.5 3.5 14.5 3.5 20 0v-7s9-4.5 6-10.5c-4-6.5-13.5-3.5-16 4V27v-3.5c-2.5-7.5-12-10.5-16-4-3 6 6 10.5 6 10.5v7",fill:"#000"}),Object(u.jsx)("path",{d:"M20 8h5",strokeLinejoin:"miter"}),Object(u.jsx)("path",{d:"M32 29.5s8.5-4 6.03-9.65C34.15 14 25 18 22.5 24.5v2.1-2.1C20 18 10.85 14 6.97 19.85 4.5 25.5 13 29.5 13 29.5",stroke:"#fff"}),Object(u.jsx)("path",{d:"M12.5 30c5.5-3 14.5-3 20 0m-20 3.5c5.5-3 14.5-3 20 0m-20 3.5c5.5-3 14.5-3 20 0",stroke:"#fff"})]})}))}var k=a.memo(j);function O(e){return Object(u.jsx)("svg",Object(f.a)(Object(f.a)({xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 45 45"},e),{},{children:Object(u.jsxs)("g",{fill:"none",fillRule:"evenodd",stroke:"#000",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",children:[Object(u.jsx)("path",{d:"M22.5 11.63V6M20 8h5",strokeLinejoin:"miter"}),Object(u.jsx)("path",{d:"M22.5 25s4.5-7.5 3-10.5c0 0-1-2.5-3-2.5s-3 2.5-3 2.5c-1.5 3 3 10.5 3 10.5",fill:"#fff",strokeLinecap:"butt",strokeLinejoin:"miter"}),Object(u.jsx)("path",{d:"M12.5 37c5.5 3.5 14.5 3.5 20 0v-7s9-4.5 6-10.5c-4-6.5-13.5-3.5-16 4V27v-3.5c-2.5-7.5-12-10.5-16-4-3 6 6 10.5 6 10.5v7",fill:"#fff"}),Object(u.jsx)("path",{d:"M12.5 30c5.5-3 14.5-3 20 0M12.5 33.5c5.5-3 14.5-3 20 0M12.5 37c5.5-3 14.5-3 20 0"})]})}))}var g=a.memo(O);function w(e){return Object(u.jsx)("svg",Object(f.a)(Object(f.a)({xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 45 45"},e),{},{children:Object(u.jsxs)("g",{fill:"none",fillRule:"evenodd",stroke:"#000",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",children:[Object(u.jsx)("path",{d:"M22 10c10.5 1 16.5 8 16 29H15c0-9 10-6.5 8-21",fill:"#000"}),Object(u.jsx)("path",{d:"M24 18c.38 2.91-5.55 7.37-8 9-3 2-2.82 4.34-5 4-1.042-.94 1.41-3.04 0-3-1 0 .19 1.23-1 2-1 0-4.003 1-4-4 0-2 6-12 6-12s1.89-1.9 2-3.5c-.73-.994-.5-2-.5-3 1-1 3 2.5 3 2.5h2s.78-1.992 2.5-3c1 0 1 3 1 3",fill:"#000"}),Object(u.jsx)("path",{d:"M9.5 25.5a.5.5 0 11-1 0 .5.5 0 111 0z",fill:"#fff",stroke:"#fff"}),Object(u.jsx)("path",{d:"M14.933 15.75a.5 1.5 30 11-.866-.5.5 1.5 30 11.866.5z",fill:"#fff",stroke:"#fff",strokeWidth:1.49997}),Object(u.jsx)("path",{d:"M24.55 10.4l-.45 1.45.5.15c3.15 1 5.65 2.49 7.9 6.75S35.75 29.06 35.25 39l-.05.5h2.25l.05-.5c.5-10.06-.88-16.85-3.25-21.34-2.37-4.49-5.79-6.64-9.19-7.16l-.51-.1z",fill:"#fff",stroke:"none"})]})}))}var x=a.memo(w);function m(e){return Object(u.jsx)("svg",Object(f.a)(Object(f.a)({xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 45 45"},e),{},{children:Object(u.jsxs)("g",{fill:"none",fillRule:"evenodd",stroke:"#000",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",children:[Object(u.jsx)("path",{d:"M22 10c10.5 1 16.5 8 16 29H15c0-9 10-6.5 8-21",fill:"#fff"}),Object(u.jsx)("path",{d:"M24 18c.38 2.91-5.55 7.37-8 9-3 2-2.82 4.34-5 4-1.042-.94 1.41-3.04 0-3-1 0 .19 1.23-1 2-1 0-4.003 1-4-4 0-2 6-12 6-12s1.89-1.9 2-3.5c-.73-.994-.5-2-.5-3 1-1 3 2.5 3 2.5h2s.78-1.992 2.5-3c1 0 1 3 1 3",fill:"#fff"}),Object(u.jsx)("path",{d:"M9.5 25.5a.5.5 0 11-1 0 .5.5 0 111 0z",fill:"#000"}),Object(u.jsx)("path",{d:"M14.933 15.75a.5 1.5 30 11-.866-.5.5 1.5 30 11.866.5z",fill:"#000",strokeWidth:1.49997})]})}))}var M=a.memo(m),y=function(e){return Object(u.jsx)("svg",Object(f.a)(Object(f.a)({xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 45 45"},e),{},{children:Object(u.jsx)("path",{d:"M22.5 9c-2.21 0-4 1.79-4 4 0 .89.29 1.71.78 2.38C17.33 16.5 16 18.59 16 21c0 2.03.94 3.84 2.41 5.03-3 1.06-7.41 5.55-7.41 13.47h23c0-7.92-4.41-12.41-7.41-13.47 1.47-1.19 2.41-3 2.41-5.03 0-2.41-1.33-4.5-3.28-5.62.49-.67.78-1.49.78-2.38 0-2.21-1.79-4-4-4z",stroke:"#000",strokeWidth:1.5,strokeLinecap:"round"})}))},A=a.memo(y);function P(e){return Object(u.jsx)("svg",Object(f.a)(Object(f.a)({xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 45 45"},e),{},{children:Object(u.jsx)("path",{d:"M22.5 9c-2.21 0-4 1.79-4 4 0 .89.29 1.71.78 2.38C17.33 16.5 16 18.59 16 21c0 2.03.94 3.84 2.41 5.03-3 1.06-7.41 5.55-7.41 13.47h23c0-7.92-4.41-12.41-7.41-13.47 1.47-1.19 2.41-3 2.41-5.03 0-2.41-1.33-4.5-3.28-5.62.49-.67.78-1.49.78-2.38 0-2.21-1.79-4-4-4z",fill:"#fff",stroke:"#000",strokeWidth:1.5,strokeLinecap:"round"})}))}var L=a.memo(P);function E(e){return Object(u.jsx)("svg",Object(f.a)(Object(f.a)({xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 45 45"},e),{},{children:Object(u.jsxs)("g",{stroke:"#000",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",children:[Object(u.jsx)("path",{d:"M9 26c8.5-1.5 21-1.5 27 0l2.5-12.5L31 25l-.3-14.1-5.2 13.6-3-14.5-3 14.5-5.2-13.6L14 25 6.5 13.5 9 26z",strokeLinecap:"butt"}),Object(u.jsx)("path",{d:"M9 26c0 2 1.5 2 2.5 4 1 1.5 1 1 .5 3.5-1.5 1-1 2.5-1 2.5-1.5 1.5 0 2.5 0 2.5 6.5 1 16.5 1 23 0 0 0 1.5-1 0-2.5 0 0 .5-1.5-1-2.5-.5-2.5-.5-2 .5-3.5 1-2 2.5-2 2.5-4-8.5-1.5-18.5-1.5-27 0zM11.5 30c3.5-1 18.5-1 22 0M12 33.5c6-1 15-1 21 0"}),Object(u.jsx)("circle",{cx:6,cy:12,r:2}),Object(u.jsx)("circle",{cx:14,cy:9,r:2}),Object(u.jsx)("circle",{cx:22.5,cy:8,r:2}),Object(u.jsx)("circle",{cx:31,cy:9,r:2}),Object(u.jsx)("circle",{cx:39,cy:12,r:2}),Object(u.jsx)("path",{d:"M11 38.5a35 35 1 0023 0",fill:"none",strokeLinecap:"butt"}),Object(u.jsx)("g",{fill:"none",stroke:"#fff",children:Object(u.jsx)("path",{d:"M11 29a35 35 1 0123 0M12.5 31.5h20M11.5 34.5a35 35 1 0022 0M10.5 37.5a35 35 1 0024 0"})})]})}))}var S=a.memo(E);function C(e){return Object(u.jsx)("svg",Object(f.a)(Object(f.a)({xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 45 45"},e),{},{children:Object(u.jsxs)("g",{fill:"#fff",stroke:"#000",strokeWidth:1.5,strokeLinejoin:"round",children:[Object(u.jsx)("path",{d:"M9 26c8.5-1.5 21-1.5 27 0l2.5-12.5L31 25l-.3-14.1-5.2 13.6-3-14.5-3 14.5-5.2-13.6L14 25 6.5 13.5 9 26z"}),Object(u.jsx)("path",{d:"M9 26c0 2 1.5 2 2.5 4 1 1.5 1 1 .5 3.5-1.5 1-1 2.5-1 2.5-1.5 1.5 0 2.5 0 2.5 6.5 1 16.5 1 23 0 0 0 1.5-1 0-2.5 0 0 .5-1.5-1-2.5-.5-2.5-.5-2 .5-3.5 1-2 2.5-2 2.5-4-8.5-1.5-18.5-1.5-27 0z"}),Object(u.jsx)("path",{d:"M11.5 30c3.5-1 18.5-1 22 0M12 33.5c6-1 15-1 21 0",fill:"none"}),Object(u.jsx)("circle",{cx:6,cy:12,r:2}),Object(u.jsx)("circle",{cx:14,cy:9,r:2}),Object(u.jsx)("circle",{cx:22.5,cy:8,r:2}),Object(u.jsx)("circle",{cx:31,cy:9,r:2}),Object(u.jsx)("circle",{cx:39,cy:12,r:2})]})}))}var T=a.memo(C);function _(e){return Object(u.jsx)("svg",Object(f.a)(Object(f.a)({xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 45 45"},e),{},{children:Object(u.jsxs)("g",{fillRule:"evenodd",stroke:"#000",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",children:[Object(u.jsx)("path",{d:"M9 39h27v-3H9v3zM12.5 32l1.5-2.5h17l1.5 2.5h-20zM12 36v-4h21v4H12z",strokeLinecap:"butt"}),Object(u.jsx)("path",{d:"M14 29.5v-13h17v13H14z",strokeLinecap:"butt",strokeLinejoin:"miter"}),Object(u.jsx)("path",{d:"M14 16.5L11 14h23l-3 2.5H14zM11 14V9h4v2h5V9h5v2h5V9h4v5H11z",strokeLinecap:"butt"}),Object(u.jsx)("path",{d:"M12 35.5h21M13 31.5h19M14 29.5h17M14 16.5h17M11 14h23",fill:"none",stroke:"#fff",strokeWidth:1,strokeLinejoin:"miter"})]})}))}function B(e){return Object(u.jsx)("svg",Object(f.a)(Object(f.a)({xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 45 45"},e),{},{children:Object(u.jsxs)("g",{fill:"#fff",fillRule:"evenodd",stroke:"#000",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",children:[Object(u.jsx)("path",{d:"M9 39h27v-3H9v3zM12 36v-4h21v4H12zM11 14V9h4v2h5V9h5v2h5V9h4v5",strokeLinecap:"butt"}),Object(u.jsx)("path",{d:"M34 14l-3 3H14l-3-3"}),Object(u.jsx)("path",{d:"M31 17v12.5H14V17",strokeLinecap:"butt",strokeLinejoin:"miter"}),Object(u.jsx)("path",{d:"M31 29.5l1.5 2.5h-20l1.5-2.5"}),Object(u.jsx)("path",{d:"M11 14h23",fill:"none",strokeLinejoin:"miter"})]})}))}var W,I={King:k,Queen:S,Knight:x,Bishop:d,Pawn:A,Rook:a.memo(_)},K={King:g,Queen:T,Knight:M,Bishop:p,Pawn:L,Rook:a.memo(B)},H=n(10),N=n.n(H),R=n(17),q=n(4),z=n.n(q),V=n(9),Q=n(18),D=n(3),G=n(5);!function(e){e[e.None=0]="None",e[e.K=1]="K",e[e.Q=2]="Q",e[e.k=4]="k",e[e.q=8]="q"}(W||(W={}));var Y=n(8),U=n(6),F=function(){function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(D.a)(this,e),this._piece=void 0,this.rank=void 0,this.file=void 0,this.rank=t,this.file=n,this._piece=a}return Object(G.a)(e,[{key:"piece",get:function(){return this._piece}},{key:"place",value:function(e){this._piece=e}},{key:"remove",value:function(){this._piece=null}},{key:"clone",value:function(){return new e(this.rank,this.file,this.piece)}}]),e}(),X=[8,7,6,5,4,3,2,1],J=["a","b","c","d","e","f","g","h"],Z={a:1,b:2,c:3,d:4,e:5,f:6,g:7,h:8},$=function(e,t){return Z[t]+8*(e-1)},ee=function(){function e(t){var n=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;Object(D.a)(this,e),this._board=void 0,this._boardMap=void 0,this.buildBoardMap=function(e){e.filter((function(e){return e.piece})).forEach((function(e){n._boardMap[$(e.rank,e.file)]={piece:e.piece,rank:e.rank,file:e.file}}))},this.clone=function(){return new e(n._board,Object(f.a)({},n._boardMap))},this.move=function(e,t){var a=n.getPieceAt(e);if(!a)throw new Error("no piece to move");n.remove(e),n.placeAt(t,a)},this.remove=function(e){if(!n.getPieceAt(e))throw new Error("no piece to remove");delete n._boardMap[$(e.rank,e.file)]},this.placeAt=function(e,t){n._boardMap[$(e.rank,e.file)]={piece:t,file:e.file,rank:e.rank}},this.getPieceAt=function(e){var t=n._boardMap[$(e.rank,e.file)];return t?t.piece:null},this.getPieces=function(e){return Object.values(n._boardMap).filter((function(t){return t.piece.colour===e})).map((function(e){return new F(e.rank,e.file,e.piece)}))},this._board=t,this._boardMap={},a?this._boardMap=a:this.buildBoardMap(t)}return Object(G.a)(e,[{key:"board",get:function(){return this._board}}]),e}(),te={move:"INVALID"},ne=function(){function e(t,n,a,i){var r=this;Object(D.a)(this,e),this.piece=void 0,this.game=void 0,this.enPassantTarget=void 0,this.castlingRights=void 0,this.getMoveAtPosition=function(e,t,n){var a=J.indexOf(e.file)+n,i=e.rank+t;return i>8||a>7||i<1||a<0?te:r.checkPosition(i,J[a])},this.checkPosition=function(e,t){return r.canTakeAt(e,t)?{move:"Capture",rank:e,file:t}:r.canMoveTo(e,t)?{move:"Move",rank:e,file:t}:te},this.isStandardMove=function(e){return"INVALID"!==e.move},this.canTakeAt=function(e,t){var n=r.game.board.getPieceAt({rank:e,file:t});return null!==n&&n.colour!==r.piece.colour},this.canMoveTo=function(e,t){return null===r.game.board.getPieceAt({rank:e,file:t})},this.piece=t,this.game=n,this.enPassantTarget=a,this.castlingRights=i}return Object(G.a)(e,[{key:"canMove",value:function(e,t){var n,a=this.potentialMoves(e),i=Object(V.a)(a);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(r.file===t.file&&r.rank===t.rank)return r}}catch(c){i.e(c)}finally{i.f()}return{move:"INVALID"}}},{key:"getMovesOnLine",value:z.a.mark((function e(t,n,a){var i,r,c,s;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=1;case 1:if(!(i<8)){e.next=16;break}if(r=J.indexOf(t.file)+a*i,!((c=t.rank+n*i)>8||r>7||c<1||r<0)){e.next=6;break}return e.abrupt("break",16);case 6:if("INVALID"!==(s=this.checkPosition(c,J[r])).move){e.next=9;break}return e.abrupt("break",16);case 9:return e.next=11,s;case 11:if("Capture"!==s.move){e.next=13;break}return e.abrupt("break",16);case 13:i++,e.next=1;break;case 16:case"end":return e.stop()}}),e,this)}))}]),e}(),ae=function(e){Object(Y.a)(n,e);var t=Object(U.a)(n);function n(){return Object(D.a)(this,n),t.apply(this,arguments)}return Object(G.a)(n,[{key:"potentialMoves",value:z.a.mark((function e(t){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.getMovesOnLine(t,-1,-1),"t0",1);case 1:return e.delegateYield(this.getMovesOnLine(t,1,1),"t1",2);case 2:return e.delegateYield(this.getMovesOnLine(t,1,-1),"t2",3);case 3:return e.delegateYield(this.getMovesOnLine(t,-1,1),"t3",4);case 4:case"end":return e.stop()}}),e,this)}))}]),n}(ne),ie=function(e){Object(Y.a)(n,e);var t=Object(U.a)(n);function n(){var e;Object(D.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).castlingDeltas=function(e){return"SHORT"===e?[0,1,2]:[0,-1,-2]},e}return Object(G.a)(n,[{key:"potentialMoves",value:z.a.mark((function e(t){var n,a,i,r,c,o,l,u,h;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[[1,1],[0,1],[1,0],[-1,0],[-1,-1],[0,-1],[-1,1],[1,-1]],a=J.indexOf(t.file),i=t.rank,r=0,c=n;case 4:if(!(r<c.length)){e.next=13;break}if(o=Object(s.a)(c[r],2),l=o[0],u=o[1],h=this.getMoveAtPosition(t,l,u),!this.isStandardMove(h)){e.next=10;break}return e.next=10,h;case 10:r++,e.next=4;break;case 13:if(!this.canCastle("SHORT")){e.next=16;break}return e.next=16,{move:"Castle",type:"SHORT",colour:this.piece.colour,rank:i,file:J[a+2]};case 16:if(!this.canCastle("LONG")){e.next=19;break}return e.next=19,{move:"Castle",type:"LONG",colour:this.piece.colour,rank:i,file:J[a-2]};case 19:case"end":return e.stop()}}),e,this)}))},{key:"canCastle",value:function(e){var t=this,n=this.castlingDeltas(e),a="WHITE"===this.piece.colour?1:8,i=W.None;return i="BLACK"===this.piece.colour?"SHORT"===e?W.k:W.q:"SHORT"===e?W.K:W.Q,!!(this.castlingRights&i)&&n.every((function(e){var n=4+e;return null===t.game.board.getPieceAt({file:J[n],rank:a})||0===e}))}}]),n}(ne),re=function(e){Object(Y.a)(n,e);var t=Object(U.a)(n);function n(){return Object(D.a)(this,n),t.apply(this,arguments)}return Object(G.a)(n,[{key:"potentialMoves",value:z.a.mark((function e(t){var n,a,i,r,c,o,l;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[[1,2],[2,1],[-1,2],[-2,1],[-1,-2],[-2,-1],[1,-2],[2,-1]],null!==this.game.board.getPieceAt(t)){e.next=4;break}throw new Error("nope");case 4:a=0,i=n;case 5:if(!(a<i.length)){e.next=14;break}if(r=Object(s.a)(i[a],2),c=r[0],o=r[1],l=this.getMoveAtPosition(t,c,o),!this.isStandardMove(l)){e.next=11;break}return e.next=11,l;case 11:a++,e.next=5;break;case 14:case"end":return e.stop()}}),e,this)}))}]),n}(ne),ce=function(e){Object(Y.a)(n,e);var t=Object(U.a)(n);function n(){return Object(D.a)(this,n),t.apply(this,arguments)}return Object(G.a)(n,[{key:"potentialMoves",value:z.a.mark((function e(t){var n,a,i,r,c,o,l,u,h,f,v,d=this;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="WHITE"===this.piece.colour?1:-1,a=this.pieceMoved(t),i=[[n,1],[n,-1]],r=t.rank+n,c=!0,0!==r&&9!==r||(c=!1),!(o=!!c&&this.canMoveTo(r,t.file))){e.next=10;break}return e.next=10,{move:"Move",rank:r,file:t.file};case 10:if(!o||a){e.next=16;break}if(l=t.rank+2*n,!this.canMoveTo(l,t.file)){e.next=16;break}return e.next=16,{move:"PawnPush",rank:l,file:t.file};case 16:u=i.map((function(e){var n=Object(s.a)(e,2),a=n[0],i=n[1];return d.getMoveAtPosition(t,a,i)})).filter(this.isStandardMove).filter((function(e){return"Capture"===e.move})),i.forEach((function(e){var n,a,i=Object(s.a)(e,2),r=i[0],c=i[1],o=t.rank+r,l=J[J.indexOf(t.file)+c];(null===(n=d.enPassantTarget)||void 0===n?void 0:n.file)===l&&(null===(a=d.enPassantTarget)||void 0===a?void 0:a.rank)===o&&u.push({move:"CaptureEnPassant",rank:o,file:l})})),h=Object(V.a)(u),e.prev=19,h.s();case 21:if((f=h.n()).done){e.next=27;break}return v=f.value,e.next=25,v;case 25:e.next=21;break;case 27:e.next=32;break;case 29:e.prev=29,e.t0=e.catch(19),h.e(e.t0);case 32:return e.prev=32,h.f(),e.finish(32);case 35:case"end":return e.stop()}}),e,this,[[19,29,32,35]])}))},{key:"pieceMoved",value:function(e){return("WHITE"===this.piece.colour?2:7)!==e.rank}}]),n}(ne),se=function(e){Object(Y.a)(n,e);var t=Object(U.a)(n);function n(){return Object(D.a)(this,n),t.apply(this,arguments)}return Object(G.a)(n,[{key:"potentialMoves",value:z.a.mark((function e(t){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.getMovesOnLine(t,1,0),"t0",1);case 1:return e.delegateYield(this.getMovesOnLine(t,0,1),"t1",2);case 2:return e.delegateYield(this.getMovesOnLine(t,0,-1),"t2",3);case 3:return e.delegateYield(this.getMovesOnLine(t,-1,0),"t3",4);case 4:case"end":return e.stop()}}),e,this)}))}]),n}(ne),oe=function(e){Object(Y.a)(n,e);var t=Object(U.a)(n);function n(){return Object(D.a)(this,n),t.apply(this,arguments)}return Object(G.a)(n,[{key:"potentialMoves",value:z.a.mark((function e(t){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(new se(this.piece,this.game,this.enPassantTarget,this.castlingRights).potentialMoves(t),"t0",1);case 1:return e.delegateYield(new ae(this.piece,this.game,this.enPassantTarget,this.castlingRights).potentialMoves(t),"t1",2);case 2:case"end":return e.stop()}}),e,this)}))}]),n}(ne),le=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:W.None;switch(e.pieceType){case"BISHOP":return new ae(e,t,n,a);case"KING":return new ie(e,t,n,a);case"KNIGHT":return new re(e,t,n,a);case"PAWN":return new ce(e,t,n,a);case"QUEEN":return new oe(e,t,n,a);case"ROOK":return new se(e,t,n,a)}},ue=function e(t){Object(D.a)(this,e),this.pieceType=void 0,this.colour=void 0,this.colour=t},he=function(e){Object(Y.a)(n,e);var t=Object(U.a)(n);function n(){var e;Object(D.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).pieceType="BISHOP",e}return n}(ue),fe=function(e){Object(Y.a)(n,e);var t=Object(U.a)(n);function n(){var e;Object(D.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).pieceType="KING",e}return n}(ue),ve=function(e){Object(Y.a)(n,e);var t=Object(U.a)(n);function n(){var e;Object(D.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).pieceType="KNIGHT",e}return n}(ue),de=function(e){Object(Y.a)(n,e);var t=Object(U.a)(n);function n(){var e;Object(D.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).pieceType="QUEEN",e}return n}(ue),be=function(e){Object(Y.a)(n,e);var t=Object(U.a)(n);function n(){var e;Object(D.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).pieceType="ROOK",e}return n}(ue),pe=function(e){Object(Y.a)(n,e);var t=Object(U.a)(n);function n(){var e;Object(D.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).pieceType="PAWN",e}return n}(ue),je=function(){var e=X.flatMap((function(e){return J.map((function(t){return new F(e,t)}))})),t=function(t,n,a){var i=e.find((function(e){return e.file===n&&e.rank===t}));null===i||void 0===i||i.place(a)};return t(1,"a",new be("WHITE")),t(1,"b",new ve("WHITE")),t(1,"c",new he("WHITE")),t(1,"d",new de("WHITE")),t(1,"e",new fe("WHITE")),t(1,"f",new he("WHITE")),t(1,"g",new ve("WHITE")),t(1,"h",new be("WHITE")),t(2,"a",new pe("WHITE")),t(2,"b",new pe("WHITE")),t(2,"c",new pe("WHITE")),t(2,"d",new pe("WHITE")),t(2,"e",new pe("WHITE")),t(2,"f",new pe("WHITE")),t(2,"g",new pe("WHITE")),t(2,"h",new pe("WHITE")),t(7,"a",new pe("BLACK")),t(7,"b",new pe("BLACK")),t(7,"c",new pe("BLACK")),t(7,"d",new pe("BLACK")),t(7,"e",new pe("BLACK")),t(7,"f",new pe("BLACK")),t(7,"g",new pe("BLACK")),t(7,"h",new pe("BLACK")),t(8,"a",new be("BLACK")),t(8,"b",new ve("BLACK")),t(8,"c",new he("BLACK")),t(8,"d",new de("BLACK")),t(8,"e",new fe("BLACK")),t(8,"f",new he("BLACK")),t(8,"g",new ve("BLACK")),t(8,"h",new be("BLACK")),e},ke=(new be("WHITE"),new ve("WHITE"),new he("WHITE"),new de("WHITE"),new fe("WHITE"),new he("WHITE"),new ve("WHITE"),new be("WHITE"),new pe("WHITE"),new pe("WHITE"),new pe("WHITE"),new pe("WHITE"),new pe("WHITE"),new pe("WHITE"),new pe("WHITE"),new pe("WHITE"),new be("BLACK"),new ve("BLACK"),new he("BLACK"),new de("BLACK"),new fe("BLACK"),new he("BLACK"),new ve("BLACK"),new be("BLACK"),new pe("BLACK"),new pe("BLACK"),new pe("BLACK"),new pe("BLACK"),new pe("BLACK"),new pe("BLACK"),new pe("BLACK"),new pe("BLACK"),function(e){return e.enPassantSquare?"".concat(e.enPassantSquare.file).concat(e.enPassantSquare.rank):"-"}),Oe=function(e){var t="";return e.CastlingAbility&W.K&&(t+="K"),e.CastlingAbility&W.Q&&(t+="Q"),e.CastlingAbility&W.k&&(t+="k"),e.CastlingAbility&W.q&&(t+="q"),""===t?"-":t},ge=function(e){var t=[];return X.forEach((function(n){var a=0,i="";J.forEach((function(t){var r=e.getPieceAt({rank:n,file:t});if(r){a>0&&(i+=a,a=0);var c="";switch(r.pieceType){case"BISHOP":c="b";break;case"KING":c="k";break;case"KNIGHT":c="n";break;case"PAWN":c="p";break;case"QUEEN":c="q";break;case"ROOK":c="r"}"WHITE"===r.colour&&(c=c.toUpperCase()),i+=c}else"h"===t&&(i+=++a);r||(a+=1)})),t.push(i)})),t.join("/")},we=new(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ee(je()),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"WhiteMove",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:W.K|W.Q|W.k|W.q,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0;Object(D.a)(this,e),this._intState=void 0,this.seenBoardPositions={},this._intState={board:t,halfMoves:i,fullMoves:a,castlingAbility:r,state:n,enPassantSquare:c}}return Object(G.a)(e,[{key:"board",get:function(){return this._intState.board}},{key:"clone",value:function(){return new e(this._intState.board.clone(),this._intState.state,this._intState.fullMoves,this._intState.halfMoves,this._intState.castlingAbility,this._intState.enPassantSquare)}},{key:"FullMoves",get:function(){return this._intState.fullMoves}},{key:"HalfMoves",get:function(){return this._intState.halfMoves}},{key:"enPassantSquare",get:function(){return this._intState.enPassantSquare}},{key:"CastlingAbility",get:function(){return this._intState.castlingAbility}},{key:"state",get:function(){return this._intState.state}},{key:"moves",value:z.a.mark((function e(t){var n,a,i,r,c,s,o,l,u,h,f;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.board.getPieces(t),a=n.find((function(e){var t;return"KING"===(null===(t=e.piece)||void 0===t?void 0:t.pieceType)})),i=n.filter((function(e){var t;return"KING"!==(null===(t=e.piece)||void 0===t?void 0:t.pieceType)})),r=0,c=[a].concat(Object(Q.a)(i));case 4:if(!(r<c.length)){e.next=30;break}s=c[r],o=le(s.piece,this,this.enPassantSquare,this.CastlingAbility),l=o.potentialMoves({rank:s.rank,file:s.file}),u=Object(V.a)(l),e.prev=9,u.s();case 11:if((h=u.n()).done){e.next=19;break}if(f=h.value,!this.clone().move({file:s.file,rank:s.rank},{file:f.file,rank:f.rank})){e.next=17;break}return e.next=17,f;case 17:e.next=11;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(9),u.e(e.t0);case 24:return e.prev=24,u.f(),e.finish(24);case 27:r++,e.next=4;break;case 30:case"end":return e.stop()}}),e,this,[[9,21,24,27]])}))},{key:"promote",value:function(e){if("BlackPromote"===this.state||"WhitePromote"===this.state){var t,n="BlackPromote"===this.state?"BLACK":"WHITE",a="BlackPromote"===this.state?1:8,i=this.board.getPieces(n).find((function(e){var t;return"PAWN"===(null===(t=e.piece)||void 0===t?void 0:t.pieceType)&&e.rank===a}));switch(this.board.remove(i),e){case"BISHOP":t=new he(n);break;case"KNIGHT":t=new ve(n);break;case"QUEEN":t=new de(n);break;case"ROOK":t=new be(n);break;default:throw new Error("Not a promotable piece")}return this.board.placeAt(i,t),void this.changeState(n)}}},{key:"movesPerf",value:z.a.mark((function e(t){var n,a,i,r,c,s,o,l;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.board.getPieces(t),a=Object(V.a)(n),e.prev=2,a.s();case 4:if((i=a.n()).done){e.next=28;break}r=i.value,c=le(r.piece,this,this.enPassantSquare,this.CastlingAbility).potentialMoves({rank:r.rank,file:r.file}),s=Object(V.a)(c),e.prev=8,s.s();case 10:if((o=s.n()).done){e.next=18;break}if(l=o.value,!this.clone().move({file:r.file,rank:r.rank},{file:l.file,rank:l.rank})){e.next=16;break}return e.next=16,{move:l,from:r};case 16:e.next=10;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(8),s.e(e.t0);case 23:return e.prev=23,s.f(),e.finish(23);case 26:e.next=4;break;case 28:e.next=33;break;case 30:e.prev=30,e.t1=e.catch(2),a.e(e.t1);case 33:return e.prev=33,a.f(),e.finish(33);case 36:case"end":return e.stop()}}),e,this,[[2,30,33,36],[8,20,23,26]])}))},{key:"move",value:function(e,t){var n=this.board.getPieceAt(e);if(!n)throw new Error("No Piece to move");var a=n,i=Object(f.a)(Object(f.a)({},this._intState),{},{board:this.board.clone()}),r=this.move2(e,t);return r&&this.kingInCheck(a.colour)?(this._intState=i,!1):(r&&this.changeState(a.colour),r)}},{key:"kingInCheck",value:function(e){var t,n=this.board.getPieces(e).find((function(e){var t;return"KING"===(null===(t=e.piece)||void 0===t?void 0:t.pieceType)})),a=this.board.getPieces("WHITE"===e?"BLACK":"WHITE"),i=Object(V.a)(a);try{for(i.s();!(t=i.n()).done;){var r,c=t.value,s=le(c.piece,this).potentialMoves({file:c.file,rank:c.rank}),o=Object(V.a)(s);try{for(o.s();!(r=o.n()).done;){var l=r.value;if(l.file===(null===n||void 0===n?void 0:n.file)&&l.rank===(null===n||void 0===n?void 0:n.rank))return!0}}catch(u){o.e(u)}finally{o.f()}}}catch(u){i.e(u)}finally{i.f()}return!1}},{key:"hasPieceToPromote",value:function(e){var t="BLACK"===e?1:8;return this.board.getPieces(e).filter((function(e){var t;return"PAWN"===(null===(t=e.piece)||void 0===t?void 0:t.pieceType)})).some((function(e){return e.rank===t}))}},{key:"move2",value:function(e,t){var n=this.board.getPieceAt(e);if(!n)throw new Error("No Piece to move");if("BlackMove"===this.state&&"WHITE"===(null===n||void 0===n?void 0:n.colour))return!1;if("WhiteMove"===this.state&&"BLACK"===(null===n||void 0===n?void 0:n.colour))return!1;if("WhiteMove"!==this.state&&"BlackMove"!==this.state)return!1;var a=n,i=le(n,this,this.enPassantSquare,this.CastlingAbility).canMove(e,t);switch(i.move){case"INVALID":return!1;case"Move":case"PawnPush":case"CaptureEnPassant":case"Capture":if("CaptureEnPassant"===i.move){if(!this.enPassantSquare)throw new Error("no enPassant");this.board.remove({rank:e.rank,file:this.enPassantSquare.file})}if(this.board.move(e,t),"PawnPush"===i.move){var r=t.rank;"WHITE"===a.colour?r-=1:r+=1,this._intState.enPassantSquare={rank:r,file:i.file}}else this._intState.enPassantSquare=void 0;"KING"===a.pieceType&&("WHITE"===a.colour&&(this._intState.castlingAbility&=~W.K,this._intState.castlingAbility&=~W.Q),"BLACK"===a.colour&&(this._intState.castlingAbility&=~W.k,this._intState.castlingAbility&=~W.q)),"ROOK"===a.pieceType&&(1===e.rank&&"a"===e.file&&(this._intState.castlingAbility&=~W.Q),1===e.rank&&"h"===e.file&&(this._intState.castlingAbility&=~W.K),8===e.rank&&"a"===e.file&&(this._intState.castlingAbility&=~W.q),8===e.rank&&"h"===e.file&&(this._intState.castlingAbility&=~W.k)),"Capture"===i.move&&(1===t.rank&&"a"===t.file&&(this._intState.castlingAbility&=~W.Q),1===t.rank&&"h"===t.file&&(this._intState.castlingAbility&=~W.K),8===t.rank&&"a"===t.file&&(this._intState.castlingAbility&=~W.q),8===t.rank&&"h"===t.file&&(this._intState.castlingAbility&=~W.k)),"Capture"===i.move||"CaptureEnPassant"===i.move||"PawnPush"===i.move||"Move"===i.move&&"PAWN"===a.pieceType?this._intState.halfMoves=0:this._intState.halfMoves+=1;break;case"Castle":this.board.move(e,t);var c={rank:e.rank,file:"SHORT"===i.type?"h":"a"},s={rank:e.rank,file:"SHORT"===i.type?"f":"d"};this.board.move(c,s),"WHITE"===a.colour&&(this._intState.castlingAbility&=~W.K,this._intState.castlingAbility&=~W.Q),"BLACK"===a.colour&&(this._intState.castlingAbility&=~W.k,this._intState.castlingAbility&=~W.q)}var o=ge(this.board);return this.seenBoardPositions[o]?this.seenBoardPositions[o]+=1:this.seenBoardPositions[o]=1,!0}},{key:"checkMate",value:function(e){if(this.kingInCheck(e)){var t,n=Object(V.a)(this.moves(e));try{for(n.s();!(t=n.n()).done;){t.value;return!1}}catch(a){n.e(a)}finally{n.f()}return!0}return!1}},{key:"staleMate",value:function(e){var t,n=this.board.getPieces(e),a=Object(V.a)(n);try{for(a.s();!(t=a.n()).done;){var i,r=t.value,c=le(r.piece,this,this.enPassantSquare,this.CastlingAbility).potentialMoves({rank:r.rank,file:r.file}),s=Object(V.a)(c);try{for(s.s();!(i=s.n()).done;)return Object(R.a)(i.value),!1}catch(o){s.e(o)}finally{s.f()}}}catch(o){a.e(o)}finally{a.f()}return!0}},{key:"changeState",value:function(e){if(Object.values(this.seenBoardPositions).includes(3))this._intState.state="DrawRepetition3";else switch(this.state){case"BlackWin":case"StaleMate":case"WhiteWin":case"DrawRepetition3":case"DrawRepetition5":break;case"WhitePromote":case"WhiteMove":if("BLACK"===e)break;this._intState.state="BlackMove",this.hasPieceToPromote(e)?this._intState.state="WhitePromote":this.checkMate("BLACK")?this._intState.state="WhiteWin":this.staleMate("BLACK")&&(this._intState.state="StaleMate");break;case"BlackPromote":case"BlackMove":if("WHITE"===e)break;this._intState.state="WhiteMove",this.hasPieceToPromote(e)?this._intState.state="BlackPromote":this.checkMate("WHITE")?this._intState.state="BlackWin":this.staleMate("WHITE")&&(this._intState.state="StaleMate"),this._intState.fullMoves+=1}}}]),e}()),xe={board:we.board,state:we.state,game:we},me=Object(a.createContext)([xe,function(){return null}]),Me=function(e,t){switch(t.type){case"PIECE_HOVER":if(!e.activePiece)throw new Error("state is corrupted");return Object(f.a)(Object(f.a)({},e),{},{activePiece:Object(f.a)(Object(f.a)({},e.activePiece),{},{x:t.payload.x,y:t.payload.y})});case"PIECE_ACTIVATED":return Object(f.a)(Object(f.a)({},e),{},{activePiece:Object(f.a)({},t.payload)});case"SQUARE_ATTACKED":return Object(f.a)(Object(f.a)({},e),{},{threatenedSquare:Object(f.a)({},t.payload)});case"PROMOTE":return we.promote(t.payload.piece),{board:we.board,state:we.state,game:we};case"MOVE":if(!e.threatenedSquare)throw new Error("state is corrupted");if(!e.activePiece)throw new Error("state is corrupted");var n={file:e.activePiece.file,rank:e.activePiece.rank},a={file:e.threatenedSquare.file,rank:e.threatenedSquare.rank};if("WhiteMove"===e.state)try{we.move(n,a)}catch(i){console.log(i)}return{board:we.board,state:we.state,game:we};case"BLACKMOVE":try{we.move(t.payload.from,t.payload.to)}catch(i){console.log(i)}return{board:we.board,state:we.state,game:we}}},ye=function(e){var t=e.children,n=Object(a.useReducer)(Me,xe),i=Object(s.a)(n,2),r=i[0],c=i[1];return Object(u.jsx)(me.Provider,{value:[r,c],children:t})},Ae=n(11),Pe=n.n(Ae),Le=function(e){var t=e.colour,n=e.promoteCallback,a="WHITE"===t?K:I,i=a.Queen,r=a.Bishop,c=a.Rook,s=a.Knight;return Object(u.jsxs)("section",{className:Pe.a.promotionSection,children:[Object(u.jsx)("span",{children:"Select piece to promote to"}),Object(u.jsxs)("div",{className:Pe.a.chessRow,children:[Object(u.jsx)("div",{className:"".concat(Pe.a.chessSquare),onClick:function(){return n("QUEEN")},children:Object(u.jsx)(i,{})}),Object(u.jsx)("div",{className:"".concat(Pe.a.chessSquare),onClick:function(){return n("BISHOP")},children:Object(u.jsx)(r,{})}),Object(u.jsx)("div",{className:"".concat(Pe.a.chessSquare),onClick:function(){return n("ROOK")},children:Object(u.jsx)(c,{})}),Object(u.jsx)("div",{className:"".concat(Pe.a.chessSquare," "),onClick:function(){return n("KNIGHT")},children:Object(u.jsx)(s,{})})]})]})},Ee=function(e){var t=e.rank,n=e.file,i=e.bound,r=Object(a.useRef)(null),c=Object(a.useContext)(me),o=Object(s.a)(c,2),l=o[0],f=o[1],v=Object(a.useState)(!1),d=Object(s.a)(v,2),b=d[0],p=d[1],j=function(e,t){return e%2===0&&J.indexOf(t)%2===0||e%2===1&&J.indexOf(t)%2===1}(t,n),k=function(e,t,n){var a=n.getPieceAt({rank:e,file:t});if(a){var i="WHITE"===a.colour?K:I;switch(a.pieceType){case"BISHOP":return i.Bishop;case"KING":return i.King;case"KNIGHT":return i.Knight;case"PAWN":return i.Pawn;case"QUEEN":return i.Queen;case"ROOK":return i.Rook}}}(t,n,l.board);Object(a.useEffect)((function(){var e,t=null===(e=r.current)||void 0===e?void 0:e.getBoundingClientRect();t&&(l.activePiece&&l.activePiece.x>=(null===t||void 0===t?void 0:t.left)&&l.activePiece.x<(null===t||void 0===t?void 0:t.right)&&l.activePiece.y>=t.top&&l.activePiece.y<t.bottom?p(!0):p(!1))}),[l,t,n]),Object(a.useEffect)((function(){b&&f({type:"SQUARE_ATTACKED",payload:{rank:t,file:n}})}),[b,f,n,t]);var O=Object(a.useCallback)((function(e,t){return f({type:"PIECE_HOVER",payload:{x:e,y:t}})}),[f]),g=Object(a.useCallback)((function(e,a){return f({type:"PIECE_ACTIVATED",payload:{rank:t,file:n,x:e,y:a}})}),[f,t,n]),w=Object(a.useCallback)((function(){return f({type:"MOVE"})}),[f]);return Object(u.jsxs)("div",{className:"".concat(N.a.chessSquare," ").concat(j?N.a.light:""," ").concat(b?N.a.highlighted:""," ").concat(N.a["rank_".concat(t)]," ").concat(N.a["file_".concat(n)]),rank:t,file:n,ref:r,children:[k&&Object(u.jsx)(h,{boundingBox:i,onMouseUp:w,onMouseMove:O,onMouseDown:g,children:Object(u.jsx)(k,{})}),1===t&&Object(u.jsx)("div",{className:N.a.rank,children:n}),"a"===n&&Object(u.jsx)("div",{className:N.a.file,children:t})]},t+n)},Se=function(e){switch(e){case"BlackMove":return"Black to move";case"BlackWin":return"Black Won!";case"StaleMate":return"Stalemate";case"WhiteMove":return"White to move";case"WhiteWin":return"White Won!";case"DrawRepetition3":return"Draw by repetition";default:return e}},Ce=function(){var e,t=Object(a.useContext)(me),n=Object(s.a)(t,2),i=n[0],r=n[1],c=function(e){var t=Object(a.useState)((function(){return console.log("created a stockfish"),new Worker("/chess/stockfish.asm.js")})),n=Object(s.a)(t,1)[0];return Object(a.useEffect)((function(){n.postMessage("uci"),n.postMessage("setoption name Skill Level value 10"),n.onmessage=function(t){if(console.log(t.data),t.data.indexOf("bestmove")>-1){var n=t.data.match(/bestmove\s+(\S+)/);n&&(console.log("Best move: "+n[1]),e(n[1]))}}}),[e,n]),Object(a.useCallback)((function(e){console.log("Hello"),console.log(e),n.postMessage("position fen ".concat(e)),n.postMessage("go depth 10"),setTimeout((function(){n.postMessage("stop")}),5e3)}),[n])}(Object(a.useCallback)((function(e){var t=e.split(""),n={file:t[0],rank:parseInt(t[1])},a={file:t[2],rank:parseInt(t[3])};r({type:"BLACKMOVE",payload:{from:n,to:a}})}),[r])),o=Object(a.useRef)(null),l=Object(a.useState)(),h=Object(s.a)(l,2),f=h[0],v=h[1],d=Object(a.useCallback)((function(){var e;v(null===(e=o.current)||void 0===e?void 0:e.getBoundingClientRect())}),[]);e=d,Object(a.useEffect)((function(){var t=function(){e()};return window.addEventListener("resize",t),t(),function(){return window.removeEventListener("resize",t)}}),[e]),Object(a.useEffect)((function(){var e;v(null===(e=o.current)||void 0===e?void 0:e.getBoundingClientRect())}),[o]);var b=function(e){r({type:"PROMOTE",payload:{piece:e}})};return Object(a.useEffect)((function(){var e;"BlackMove"===i.state&&c("BlackMove"===(e=i.game).state||"WhiteMove"===e.state?"".concat(ge(e.board)," ").concat("WhiteMove"===e.state?"w":"b"," ").concat(Oe(e)," ").concat(ke(e)," ").concat(e.HalfMoves," ").concat(e.FullMoves):"")}),[c,i.game,i.state]),Object(u.jsxs)("div",{className:N.a.container,children:[Object(u.jsx)("div",{ref:o,className:N.a.chessGrid,children:X.map((function(e){return J.map((function(t){return Object(u.jsx)(Ee,{rank:e,file:t,bound:f},e+t)}))}))}),Object(u.jsx)("div",{className:N.a.infoPane,children:Se(i.state)}),"WhitePromote"===i.state&&Object(u.jsx)(Le,{colour:"WHITE",promoteCallback:b}),"BlackPromote"===i.state&&Object(u.jsx)(Le,{colour:"BLACK",promoteCallback:b})]})};var Te=function(){return Object(u.jsx)(ye,{children:Object(u.jsx)(Ce,{})})},_e=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,27)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,r=t.getLCP,c=t.getTTFB;n(e),a(e),i(e),r(e),c(e)}))};c.a.render(Object(u.jsx)(i.a.StrictMode,{children:Object(u.jsx)(Te,{})}),document.getElementById("root")),_e()}},[[26,1,2]]]);
//# sourceMappingURL=main.797db6f0.chunk.js.map